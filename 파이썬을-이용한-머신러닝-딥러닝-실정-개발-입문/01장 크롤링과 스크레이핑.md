# 1장 크롤링과 스크레이핑
이번 장에서는 실제로 프로그램을 만들어 데이터를 수집해보겠습니다. 이러한 과정을 크롤링 또는 스크레이핑이라고 하며 이번 장은 크롤링/스크레이핑과 관련된 기숭르 살펴보는 장입니다. 또한 책의 부록에서 도커(Docker) 를 이용한 파이썬 개발 환경 구축 방법도 설명하는 데 부록을 보고 개발 환경응ㄹ 설정한 뒤에 이번 장으 ㅣ내용을 함께 진행하면 좋습니다.

## 101. 데이터 다운로드하기
파이썬으로 웹 사이트에서 데이터를 다운로드하는 방법을 소개합니다. 일단 파이썬에서 표준적으로 제공하는 "urllib" 이라는 라이브러리를 사용해봅시다.

이번 절에서 배울 내용
* 파이썬의 네트워크 라이브러리 urllib
* urllib 을 이용한 다운로드

알고리즘과 툴
* urllib

## 웹상에서 정보를 추출하는 방법
파이썬은 웹 사이트에 있는 데이터를 추출하기 위해 "urllib 라이브러리" 를 사용합니다. 이 라이브러리를 이용하면 HTTP 또는 FTP 를 사용해 데이터를 다운로드 할 수 있습니다.

## urllib, request 를 이용한 다운로드
일단 웹 사이트에서 파일을 다운로드하는 방법을 설펴봅시다.
파일을 다운로드할 때는 urllib, request 모듈에 있는 urlretrieve() 함수를 사용합니다. 이 함수를 이용하면 직접 파일을 다운로드할 수 있습니다.

다음 코드는 웹에 있는 PNG 파일을 "test.png" 라는 이름의 파일로 저장한 예입니다.

download-png1.py
```
# 라이브러리 읽어 들이기 --- (※1)
import urllib.request

# URL과 저장 경로 지정하기
url = "http://uta.pw/shodou/img/28/214.png"
savename = "test.png"

# 다운로드 --- (※2)
urllib.request.urlretrieve(url, savename)
print("저장되었습니다...!")
```

다음과 같이 프로그램을 명령줄에서 실행해봅시다. PNG 파일이 다운로드되는 것을 확인할 수 있습니다.
```
python3 download-png1.py
```

그럼 파이썬 프로그램을 확인해봅시다.

파이썬 라이브러리를 사용하려면 import 구문을 사용해 라이브러리를 읽어 들여야 함니다. 프로그램에서는 (※1) 에서 urllib.request 모듈을 읽어 들입니다. "urllib.request" 처럼 점(".") 으로 구분된 모듈을 지정하는 것은 "urllib 패키지 내부에 있는 request 모듈" 이라는 의미입니다. 프로그램의 (※2) 에서 파일을 다운로드합니다. urlretrieve() 의 첫번째 매개변수에 URL 을 두번쨰 매개변수에 저장할 파일의 경로를 지정합니다.

파이썬을 이용하면 파일을 다운로드할 때 이처럼 몇 줄의 코드만 있으면 된답니다.

### urlopen() 으로 파일에 저장하는 방법
방금 살펴본 예제에서는 request.urlretrieve() 함수를 사용해 파일에 곧바로 저장했는 데 이번에는 request.urlopen() 을 사용하는 방법을 소개하겠습니다. request.urlopen() 을 이용하면 곧바라 파일을 저장하는 것이 아니라 데이터를 파이썬의 메모리 위에 올릴수 있습니다.

그럼 request.urlopen() 을 이용해 메모리 위에 데이터를 올리고 이후에 파일에 저장해 봅시다. 이 과정은 데이터를 추출하고 파일로 저장하는 흐름에 따라 진행됩니다.

file: src/ch1/download-png2.py
```
import urllib.request 

# URL과 저장 경로 지정하기
url = "http://uta.pw/shodou/img/28/214.png"
savename = "test.png"

# 다운로드 --- (※1)
mem = urllib.request.urlopen(url).read()

# 파일로 저장하기 --- (※2)
with open(savename, mode="wb") as f:
    f.write(mem)
    print("저장되었습니다...!")
```

프로그램을 명령줄에서 실행하면 png 파일이 test.png 라는 이릉으로 저장됩니다.

```
python3 download-png2.py
저장되었습니다....!
```

그럼 곧바라 프로그램을 확인해봅시다.

(※1) 에서는 urlopen() 함수로 PNG 파일의 URL 리소스를 엽니다. 이어서 read() 메서드로 데이터를 읽어 들입니다. 그리고 (※2) 에서는 파일을 여는 open() 함수로 파일을 엽니다. 이떄 파일을 읽고 쓰기 모드를 나타내는 mode 를 "wb" 로 파일을 엽니다. "w" 는 쓰기 모드, "b" 는 바이너리 모드를 의미합니다.

## 웹에서 데이터 추출하기
이어서 웹에서 XML 또는  HTML 등의 텍스트 기반 데이터를 다운로드하는 방법을 소개하겠습니다. 이번에는 간단한 다운로드 예로 필자가 운용하는 웹 API 를 사용해 보겠습니다.

```
책과 함께 제공되는 웹 API
http://api.aoikujira.com
```

### 클라이언트 접속 정보 출력해보기